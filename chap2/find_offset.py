#!/usr/bin/env python
import sys

base_addr = int(sys.argv[1], 16)

f = open(sys.argv[2], 'r') # gadgets

for line in f.readlines():
  split_list = line.split(':')
  if len(split_list) == 2:
#    target_str, gadget = line.split(':')
    target_str, gadget = split_list
  else:
    if len(split_list) == 3:
      target_str, gadget = split_list[0], ':'.join(split_list[1:])
    else:
      for item in split_list:
        print item
      else:
        break

# for line in f.readlines():
#   target_str, gadget = line.split(':')

  target_addr = int(target_str, 16)

  # check alignment
  if target_addr % 8 != 0:
    continue
    
  offset = (target_addr - base_addr) / 8
  print 'gadget =', gadget.strip()
  print 'offset =', (1 << 64) + offset
  print 'stack addr = %x' % (target_addr & 0xffffffff)
#  break
